---
import { Image } from "astro:assets";
import { type CollectionEntry, getEntry, getEntries } from "astro:content";

type Props = {
  experience: CollectionEntry<"experience">;
};

const { experience } = Astro.props;
const { data: company } = await getEntry(
  "companies",
  experience.data.company.id,
);
const technologies = experience.data.technologies
  ? await getEntries(experience.data.technologies)
  : [];
---

<div class="rounded-2xl border border-border bg-primary-foreground p-4">
  <div class="flex flex-col gap-4">
    <div class="flex flex-row items-center gap-4">
      <Image
        class="size-20 touch-manipulation rounded-xl"
        src={company.logo}
        alt={company.name}
      />
      <div class="flex flex-col gap-0.5">
        <p class="text-base font-semibold">{experience.data.title}</p>
        <p class="text-base">{company.name}</p>
        <p class="text-sm text-muted-foreground">
          {experience.data.displayDate}
        </p>
      </div>
    </div>
    <p class="text-balance text-sm text-muted-foreground">{experience.body}</p>
    <div class="flex flex-row flex-wrap gap-2">
      {
        technologies.map((technology) => (
          <div class="flex flex-row items-center gap-1 rounded-md bg-secondary px-1.5 py-0.5 ring-1 ring-border">
            <span class={`${technology.data.logo} size-4`} />
            <p class="text-xs font-normal text-muted-foreground">
              {technology.data.name}
            </p>
          </div>
        ))
      }
    </div>
  </div>
</div>
